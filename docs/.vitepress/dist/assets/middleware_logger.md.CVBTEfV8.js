import{_ as i,c as a,o as t,ag as e}from"./chunks/framework.dvv-DFtf.js";const g=JSON.parse('{"title":"Logger Middleware","description":"","frontmatter":{},"headers":[],"relativePath":"middleware/logger.md","filePath":"middleware/logger.md","lastUpdated":1767467382000}'),l={name:"middleware/logger.md"};function n(o,s,h,r,p,d){return t(),a("div",null,[...s[0]||(s[0]=[e('<h1 id="logger-middleware" tabindex="-1">Logger Middleware <a class="header-anchor" href="#logger-middleware" aria-label="Permalink to &quot;Logger Middleware&quot;">​</a></h1><p>A highly customizable HTTP request logger for Goryu. It provides detailed request/response logging with support for custom formats, colors, and output destinations.</p><h2 id="features" tabindex="-1">Features <a class="header-anchor" href="#features" aria-label="Permalink to &quot;Features&quot;">​</a></h2><ul><li><strong>Customizable Format</strong>: Define exactly what you want to log using template variables.</li><li><strong>Color Coded</strong>: Visual status codes and methods for better readability in development.</li><li><strong>Request IDs</strong>: Automatically generates or propagates <code>X-Request-ID</code>.</li><li><strong>Latency Tracking</strong>: Measures and logs request duration.</li><li><strong>Flexible Output</strong>: Write logs to stdout, files, or any <code>io.Writer</code>.</li></ul><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><h3 id="basic-setup" tabindex="-1">Basic Setup <a class="header-anchor" href="#basic-setup" aria-label="Permalink to &quot;Basic Setup&quot;">​</a></h3><p>Use the default format (colored output to stdout):</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><h3 id="custom-format" tabindex="-1">Custom Format <a class="header-anchor" href="#custom-format" aria-label="Permalink to &quot;Custom Format&quot;">​</a></h3><p>Customize the log output using template variables:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">logger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Format: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;${time} | ${status} | ${latency} | ${method} ${path} | ${error}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}))</span></span></code></pre></div><p><strong>Available Variables:</strong></p><ul><li><code>${time}</code>: Timestamp (RFC3339 by default)</li><li><code>${status}</code>: HTTP status code (colored)</li><li><code>${latency}</code>: Request duration</li><li><code>${ip}</code>: Client IP address</li><li><code>${method}</code>: HTTP method (colored)</li><li><code>${path}</code>: Request path</li><li><code>${proto}</code>: HTTP protocol version</li><li><code>${request_id}</code>: Request ID</li><li><code>${user_agent}</code>: User Agent string</li><li><code>${size}</code>: Response size in bytes</li><li><code>${error}</code>: Error message (if any)</li></ul><h3 id="json-logging-for-production" tabindex="-1">JSON Logging (for Production) <a class="header-anchor" href="#json-logging-for-production" aria-label="Permalink to &quot;JSON Logging (for Production)&quot;">​</a></h3><p>For structured logging, you can configure the format to output JSON:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">logger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Format: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`{&quot;time&quot;:&quot;${time}&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;msg&quot;:&quot;http_request&quot;,&quot;id&quot;:&quot;${request_id}&quot;,&quot;method&quot;:&quot;${method}&quot;,&quot;uri&quot;:&quot;${path}&quot;,&quot;status&quot;:${status},&quot;latency&quot;:&quot;${latency}&quot;}`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DisableColors: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}))</span></span></code></pre></div><h3 id="advanced-configuration" tabindex="-1">Advanced Configuration <a class="header-anchor" href="#advanced-configuration" aria-label="Permalink to &quot;Advanced Configuration&quot;">​</a></h3><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file, _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OpenFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;requests.log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, os.O_RDWR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">os.O_CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">os.O_APPEND, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0666</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">logger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Output:        file,</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    TimeFormat:    time.RFC1123,</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    TimeZone:      </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UTC&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DisableColors: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}))</span></span></code></pre></div><h2 id="performance-note" tabindex="-1">Performance Note <a class="header-anchor" href="#performance-note" aria-label="Permalink to &quot;Performance Note&quot;">​</a></h2><p>The logger uses a buffered writer and efficient string replacement to minimize overhead. However, for extremely high-throughput systems, consider sampling logs or using the <code>structlog</code> middleware for zero-allocation structured logging.</p>',20)])])}const E=i(l,[["render",n]]);export{g as __pageData,E as default};

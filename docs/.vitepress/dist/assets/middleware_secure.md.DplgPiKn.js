import{_ as i,c as a,o as e,ag as t}from"./chunks/framework.dvv-DFtf.js";const c=JSON.parse('{"title":"Secure Middleware","description":"","frontmatter":{},"headers":[],"relativePath":"middleware/secure.md","filePath":"middleware/secure.md","lastUpdated":1767467382000}'),n={name:"middleware/secure.md"};function l(r,s,h,o,p,k){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="secure-middleware" tabindex="-1">Secure Middleware <a class="header-anchor" href="#secure-middleware" aria-label="Permalink to &quot;Secure Middleware&quot;">​</a></h1><p>A middleware that secures your Goryu application by setting various HTTP security headers. It helps prevent XSS, clickjacking, and other common web attacks.</p><h2 id="features" tabindex="-1">Features <a class="header-anchor" href="#features" aria-label="Permalink to &quot;Features&quot;">​</a></h2><ul><li><strong>XSS Protection</strong>: Enables browser XSS filtering.</li><li><strong>Content Type Options</strong>: Prevents MIME type sniffing (<code>nosniff</code>).</li><li><strong>Frame Options</strong>: Protects against clickjacking (<code>SAMEORIGIN</code>).</li><li><strong>HSTS</strong>: Enforces HTTPS connections (Strict-Transport-Security).</li><li><strong>CSP</strong>: Configurable Content Security Policy.</li><li><strong>Referrer Policy</strong>: Controls referrer information sent in requests.</li><li><strong>Permissions Policy</strong>: Controls browser features and APIs.</li></ul><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><h3 id="basic-setup" tabindex="-1">Basic Setup <a class="header-anchor" href="#basic-setup" aria-label="Permalink to &quot;Basic Setup&quot;">​</a></h3><p>Apply default security headers:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(secure.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><p>This sets:</p><ul><li><code>X-XSS-Protection: 1; mode=block</code></li><li><code>X-Content-Type-Options: nosniff</code></li><li><code>X-Frame-Options: SAMEORIGIN</code></li><li><code>Referrer-Policy: strict-origin-when-cross-origin</code></li></ul><h3 id="https-enforcement-hsts" tabindex="-1">HTTPS Enforcement (HSTS) <a class="header-anchor" href="#https-enforcement-hsts" aria-label="Permalink to &quot;HTTPS Enforcement (HSTS)&quot;">​</a></h3><p>Enable Strict-Transport-Security for 1 year, including subdomains:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(secure.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WithHSTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">31536000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><h3 id="content-security-policy-csp" tabindex="-1">Content Security Policy (CSP) <a class="header-anchor" href="#content-security-policy-csp" aria-label="Permalink to &quot;Content Security Policy (CSP)&quot;">​</a></h3><p>Define a custom CSP:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(secure.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WithCSP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;default-src &#39;self&#39;; script-src &#39;self&#39; https://trusted.cdn.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><h3 id="advanced-configuration" tabindex="-1">Advanced Configuration <a class="header-anchor" href="#advanced-configuration" aria-label="Permalink to &quot;Advanced Configuration&quot;">​</a></h3><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(secure.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">secure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    XSSProtection:         </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1; mode=block&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ContentTypeNosniff:    </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;nosniff&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    XFrameOptions:         </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DENY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    HSTSMaxAge:            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">31536000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    HSTSIncludeSubdomains: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    HSTSPreload:           </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ContentSecurityPolicy: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;default-src &#39;self&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ReferrerPolicy:        </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;no-referrer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    PermissionsPolicy:     </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;geolocation=(), camera=()&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}))</span></span></code></pre></div><h2 id="security-note" tabindex="-1">Security Note <a class="header-anchor" href="#security-note" aria-label="Permalink to &quot;Security Note&quot;">​</a></h2><ul><li><strong>HSTS Preload</strong>: Be careful when enabling <code>HSTSPreload</code>. Once your domain is on the browser preload list, it is difficult to remove. Ensure you are committed to HTTPS for the long term.</li><li><strong>CSP</strong>: A poorly configured CSP can break your application. Test thoroughly in <code>Content-Security-Policy-Report-Only</code> mode (if supported by your setup) or development environment before enforcing.</li></ul>`,20)])])}const E=i(n,[["render",l]]);export{c as __pageData,E as default};

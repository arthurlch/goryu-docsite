import{_ as a,c as i,o as e,ag as t}from"./chunks/framework.dvv-DFtf.js";const k=JSON.parse('{"title":"TLS Redirect Middleware","description":"","frontmatter":{},"headers":[],"relativePath":"middleware/tls_redirect.md","filePath":"middleware/tls_redirect.md","lastUpdated":1767467382000}'),r={name:"middleware/tls_redirect.md"};function l(n,s,o,d,h,p){return e(),i("div",null,[...s[0]||(s[0]=[t(`<h1 id="tls-redirect-middleware" tabindex="-1">TLS Redirect Middleware <a class="header-anchor" href="#tls-redirect-middleware" aria-label="Permalink to &quot;TLS Redirect Middleware&quot;">​</a></h1><p>A middleware that automatically redirects HTTP requests to HTTPS. It supports custom ports, status codes, and proxy headers (e.g., <code>X-Forwarded-Proto</code>).</p><h2 id="features" tabindex="-1">Features <a class="header-anchor" href="#features" aria-label="Permalink to &quot;Features&quot;">​</a></h2><ul><li><strong>Automatic Redirection</strong>: Redirects all HTTP traffic to HTTPS.</li><li><strong>Proxy Support</strong>: Respects <code>X-Forwarded-Proto</code> and <code>X-Forwarded-Host</code> headers for applications behind load balancers.</li><li><strong>Customizable</strong>: Configurable redirect status code (default: 301) and HTTPS port (default: 443).</li><li><strong>Flexible Logic</strong>: Supports custom redirect logic via a callback function.</li></ul><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><h3 id="basic-setup" tabindex="-1">Basic Setup <a class="header-anchor" href="#basic-setup" aria-label="Permalink to &quot;Basic Setup&quot;">​</a></h3><p>Redirect all HTTP traffic to HTTPS on port 443:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tlsredirect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><h3 id="custom-port" tabindex="-1">Custom Port <a class="header-anchor" href="#custom-port" aria-label="Permalink to &quot;Custom Port&quot;">​</a></h3><p>If your application listens on a non-standard HTTPS port (e.g., 8443):</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tlsredirect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WithPort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><h3 id="custom-status-code" tabindex="-1">Custom Status Code <a class="header-anchor" href="#custom-status-code" aria-label="Permalink to &quot;Custom Status Code&quot;">​</a></h3><p>Use a temporary redirect (307) instead of permanent (301):</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tlsredirect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WithStatusCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(http.StatusTemporaryRedirect))</span></span></code></pre></div><h3 id="advanced-configuration" tabindex="-1">Advanced Configuration <a class="header-anchor" href="#advanced-configuration" aria-label="Permalink to &quot;Advanced Configuration&quot;">​</a></h3><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tlsredirect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tlsredirect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    StatusCode:        http.StatusMovedPermanently,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    CustomPort:        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ForwardedProtocol: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;X-Forwarded-Proto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Header to check for protocol</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ForwardedHost:     </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;X-Forwarded-Host&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Header to check for host</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}))</span></span></code></pre></div><h2 id="load-balancer-support" tabindex="-1">Load Balancer Support <a class="header-anchor" href="#load-balancer-support" aria-label="Permalink to &quot;Load Balancer Support&quot;">​</a></h2><p>This middleware is designed to work behind load balancers and reverse proxies (like Nginx, AWS ALB, Cloudflare). It checks the <code>X-Forwarded-Proto</code> header to determine if the original request was secure. If the header indicates &quot;https&quot;, the request is allowed to proceed without redirection.</p>`,18)])])}const u=a(r,[["render",l]]);export{k as __pageData,u as default};
